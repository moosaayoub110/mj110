(function(win){'use strict';var $=win.jQuery,PB=win.PB;var PBSlideshowMobileView=(function(){var $slideshowEl,$mainSliderEl,$sidebarSliderEl,$navigationTextEl,$parentDescriptionEls,$descriptionEls,$fullscreenButton,pbSlideshow,secondTime=false;function adjustDescriptionHeight(index){var $descriptionItem=$descriptionEls.eq(index),newDescriptionHeight;if($descriptionItem.length>0){if(!$descriptionItem.data('original-height')){newDescriptionHeight=$descriptionItem.outerHeight(true);$descriptionItem.data('original-height',newDescriptionHeight);}else{newDescriptionHeight=$descriptionItem.data('original-height');}
$parentDescriptionEls.css('height',newDescriptionHeight);}}
function bindUIEvents(){var buttonClasses='.js-pbslideshow-button-prev, .js-pbslideshow-button-next';$slideshowEl.on('click',buttonClasses,function(){var $button=$(this);if($button.is('.js-pbslideshow-button-prev')){pbSlideshow.prev();}else if($button.is('.js-pbslideshow-button-next')){pbSlideshow.next();}});$(win).on('pbSlideshow/change pbSlideshow/imgSlider/change',function(e,itemIndex){if(secondTime){adjustDescriptionHeight(itemIndex);}else{win.setTimeout(function(){adjustDescriptionHeight(itemIndex);secondTime=true;},500);}});$fullscreenButton.on('click',function(){pbSlideshow.goToFullScreenView();});}
return{init:function(){$slideshowEl=$('.js-pbslideshow').eq(0);$mainSliderEl=$slideshowEl.find('.js-pbslideshow-slider-wrapper');$sidebarSliderEl=$slideshowEl.find('.js-pbslideshow-descriptions');$navigationTextEl=$slideshowEl.find('.js-pbslideshow-num-images');$parentDescriptionEls=$slideshowEl.find('.js-pbslideshow-slider-description');$descriptionEls=$slideshowEl.find('.js-pbslideshow-description-inner');$fullscreenButton=$slideshowEl.find('.js-fullscreen-button');pbSlideshow=new PB.PBSlideshow($.extend({$slideshowContainer:$slideshowEl,$imgSlider:$mainSliderEl,$sidebarSlider:$sidebarSliderEl,$navigationTextEl:$navigationTextEl,$fullscreenButton:$fullscreenButton,historyAPI:$.History},$slideshowEl.data()));pbSlideshow.init();bindUIEvents();$('.pbslideshow-description-inner').jScrollPane({verticalGutter:15,autoReinitialise:true,enableKeyboardNavigation:false}).data('jsp');}};}());PB.PBSlideshowMobileView=PBSlideshowMobileView;win.PB=PB;}(window));
;(function(win){var PB=win.PB,SlideshowView=PB.SlideshowView,SlideshowMobileView=PB.PBSlideshowMobileView;PB.SlideshowMobileView=function($element,template){this.constructor.call(this,$element,template||'galleryview');};PB.SlideshowMobileView.prototype=Object.create(SlideshowView.prototype);PB.SlideshowMobileView.prototype.init=function(){SlideshowMobileView.init();};win.PB=PB;}(window));
;(function(win){'use strict';var $=win.jQuery,PB=win.PB,MQ=PB.MQ,SlideshowView=PB.SlideshowView,SlideshowMobileView=PB.SlideshowMobileView,$slideshowEl=$('.js-pbslideshow, .js-slideshow'),slideshowView,$win=$(win),locked=false,delayer,maxSlides,index;if($slideshowEl.length>0){if(MQ.isDesktop()){slideshowView=new SlideshowView($slideshowEl);$win.on('pbSlideshow/init',function(){addKeydownListener();});}else{slideshowView=new SlideshowMobileView($slideshowEl);}
$('.js-slideshow-module').show();}
function addKeydownListener(){maxSlides=0;$('.js-pbslideshow-slider .pbslideshow-slider-item').each(function(){if(!$(this).hasClass('bx-clone')){maxSlides++;}});$win.off('keydown');$win.keydown(function(e){if(!locked){if(e.keyCode===37||e.keyCode===65){index=getCurrentIndex()-1;if(index<1){index=maxSlides;}
updateHash();}else if(e.keyCode===39||e.keyCode===68){index=getCurrentIndex()+1;if(index>maxSlides){index=1;}
updateHash();}}});}
function updateHash(){locked=true;clearTimeout(delayer);delayer=setTimeout(changeSlide,750);}
function changeSlide(){index--;$win.trigger('pbSlideshow/imgSlider/change',index);locked=false;}
function getCurrentIndex(){var hash=window.location.hash;hash=hash.split('/slide/');hash=hash[hash.length-1];hash=parseInt(hash);return hash;}}(window));
;var disqus_shortname=countVars.disqusShortname;(function(){var nodes=document.getElementsByTagName('span');for(var i=0,url;i<nodes.length;i++){if(nodes[i].className.indexOf('dsq-postid')!=-1){nodes[i].parentNode.setAttribute('data-disqus-identifier',nodes[i].getAttribute('data-dsqidentifier'));url=nodes[i].parentNode.href.split('#',1);if(url.length==1){url=url[0];}
else{url=url[1];}
nodes[i].parentNode.href=url+'#disqus_thread';}}
var s=document.createElement('script');s.async=true;s.type='text/javascript';s.src='//'+disqus_shortname+'.disqus.com/count.js';(document.getElementsByTagName('HEAD')[0]||document.getElementsByTagName('BODY')[0]).appendChild(s);}());